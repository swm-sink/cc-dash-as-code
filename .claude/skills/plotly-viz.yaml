# Plotly Visualization Generation Skill

name: plotly-viz
version: 1.0.0
description: Generate appropriate Plotly visualizations based on data characteristics and user requirements

## Capabilities

capabilities:
  - Automatically select appropriate chart types for data
  - Generate Plotly Dash graph components
  - Apply consistent theming and styling
  - Ensure accessibility (WCAG 2.1 AA)
  - Optimize performance for large datasets
  - Create responsive visualizations
  - Add interactive features (tooltips, filters, zoom)

## Input Schema

inputs:
  data:
    type: object
    description: Pandas DataFrame or data structure
    required: true

  chart_type:
    type: string
    description: Desired chart type (auto-detected if not specified)
    required: false
    enum:
      - auto        # Auto-select based on data
      - bar         # Bar chart
      - line        # Line chart
      - scatter     # Scatter plot
      - histogram   # Histogram
      - box         # Box plot
      - heatmap     # Heatmap
      - pie         # Pie chart
      - area        # Area chart
      - funnel      # Funnel chart
      - sunburst    # Sunburst chart

  x_column:
    type: string
    description: Column for x-axis
    required: false

  y_column:
    type: string
    description: Column for y-axis
    required: false

  color_column:
    type: string
    description: Column for color encoding
    required: false

  title:
    type: string
    description: Chart title
    required: true

  theme:
    type: string
    description: Visual theme
    required: false
    default: "plotly"
    enum: [plotly, plotly_white, plotly_dark, ggplot2, seaborn]

  accessibility:
    type: boolean
    description: Apply accessibility enhancements
    required: false
    default: true

## Output Schema

outputs:
  component_code:
    type: string
    description: Python code for Dash dcc.Graph component
    format: python_code

  figure_object:
    type: object
    description: Plotly Figure object (if needed programmatically)

  accessibility_report:
    type: object
    description: Accessibility compliance report
    properties:
      wcag_compliant: boolean
      contrast_ratio: number
      alt_text: string
      keyboard_navigable: boolean

  performance_metrics:
    type: object
    description: Expected performance characteristics
    properties:
      data_points: integer
      estimated_render_time: string
      optimization_applied: array

## Implementation Guidelines

implementation:
  libraries:
    - plotly.express: High-level charting
    - plotly.graph_objects: Low-level control
    - dash: Dash components

  chart_selection_logic:
    categorical_x_numerical_y: "bar"
    temporal_x_numerical_y: "line"
    numerical_x_numerical_y: "scatter"
    single_numerical: "histogram"
    distribution_comparison: "box"
    correlation_matrix: "heatmap"
    part_to_whole: "pie"

  accessibility_requirements:
    - Color contrast ratio >= 4.5:1
    - Include descriptive alt text
    - Provide data table alternative
    - Support keyboard navigation
    - Use patterns in addition to color
    - Include clear axis labels
    - Ensure readable font sizes (12px minimum)

  performance_optimizations:
    - Use WebGL for > 5000 points (scattergl, scatter3d)
    - Aggregate data for > 10000 points
    - Enable data sampling for large datasets
    - Use efficient update methods
    - Implement lazy loading for multiple charts

  styling_standards:
    - Consistent color palette from theme
    - Clear, readable fonts
    - Appropriate margins and padding
    - Responsive sizing
    - Professional appearance

## Usage Examples

### Example 1: Auto-Selected Bar Chart

```yaml
input:
  data:
    month: ["Jan", "Feb", "Mar", "Apr", "May"]
    sales: [4000, 3000, 2000, 2780, 3908]
  title: "Monthly Sales"
  chart_type: "auto"

output:
  component_code: |
    import plotly.express as px
    from dash import dcc

    fig = px.bar(
        df,
        x="month",
        y="sales",
        title="Monthly Sales"
    )

    # Accessibility enhancements
    fig.update_layout(
        font=dict(size=14),
        xaxis_title="Month",
        yaxis_title="Sales ($)",
        hovermode="x unified"
    )

    graph = dcc.Graph(
        id="monthly-sales-chart",
        figure=fig,
        config={
            'displayModeBar': True,
            'displaylogo': False
        }
    )

  accessibility_report:
    wcag_compliant: true
    contrast_ratio: 7.2
    alt_text: "Bar chart showing monthly sales from January to May"
    keyboard_navigable: true
```

### Example 2: Time Series Line Chart

```yaml
input:
  data: # DataFrame with timestamp and value columns
  chart_type: "line"
  x_column: "date"
  y_column: "revenue"
  title: "Revenue Over Time"
  theme: "plotly_white"

output:
  component_code: |
    import plotly.graph_objects as go
    from dash import dcc

    fig = go.Figure()
    fig.add_trace(go.Scatter(
        x=df['date'],
        y=df['revenue'],
        mode='lines+markers',
        name='Revenue',
        line=dict(width=2),
        marker=dict(size=6)
    ))

    fig.update_layout(
        title="Revenue Over Time",
        template="plotly_white",
        xaxis_title="Date",
        yaxis_title="Revenue ($)",
        hovermode="x unified"
    )

    graph = dcc.Graph(id="revenue-chart", figure=fig)

  performance_metrics:
    data_points: 365
    estimated_render_time: "< 500ms"
    optimization_applied: []
```

## Integration with Commands

This skill is invoked by:
- `/dashboard.implement` - To generate chart code during implementation
- `component-builder` sub-agent - For autonomous component creation
- `/dashboard.review` - To validate visualization quality

## Quality Standards

- All charts meet WCAG 2.1 AA contrast requirements
- Performance: < 1s render time for standard datasets
- Responsive: Works on mobile, tablet, desktop
- Interactive: Tooltips, hover effects, zoom
- Professional: Consistent styling and theming

## Testing

test_scenarios:
  - name: "Small dataset bar chart"
    input:
      data_points: 10
      chart_type: "bar"
    assertions:
      - Code compiles without errors
      - WCAG compliant
      - Renders in < 100ms

  - name: "Large scatter plot"
    input:
      data_points: 50000
      chart_type: "scatter"
    assertions:
      - WebGL enabled
      - Renders in < 1s
      - Sampling applied if needed

  - name: "Accessibility validation"
    input:
      chart_type: "line"
      accessibility: true
    assertions:
      - Contrast ratio >= 4.5
      - Alt text provided
      - Keyboard navigable

---

*This skill generates production-ready Plotly visualizations that are accessible, performant, and beautiful.*
